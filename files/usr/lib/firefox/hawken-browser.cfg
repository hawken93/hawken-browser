// {{ ansible_managed }}
// welcome to the config file that locks down firefox privacy..

//// other stuff
// we are adults...
pref("general.warnOnAboutConfig", false);
// stop annoying us..
lockPref("browser.shell.checkDefaultBrowser", false);
// and restore my damn session okay
// 0: blank, 1: homepage, 3: last session
pref("browser.startup.page", 3);

//// privacy online

// cookies++
// defeat multi-domain tracking, goes wider than cookies
// NOTE this is aggressive, might for instance break Atlassian JIRA SSO
lockPref("privacy.firstparty.isolate", true);
// block third party cookies
// OPTIONAL. firefox kinda locks the whole section if these are locked
pref("network.cookie.cookieBehavior", 1);
// delete cookies after session quit
// OPTIONAL. some people need them to survive.
pref("network.cookie.lifetimePolicy", 2);

lockPref("privacy.donottrackheader.enabled", true);
lockPref("privacy.trackingprotection.enabled", true);
// fingerprinting
lockPref("privacy.resistFingerprinting", true);
lockPref("webgl.disabled", true);
// this one to stop leaking real IP
lockPref("media.peerconnection.enabled", false);
// disallow tracking mic / cam status
lockPref("media.navigator.enabled", false);
// firefox will use geoip to select search engine
lockPref("browser.search.geoip.url", "");
// disable geolocation ability
lockPref("geo.enabled", false);
// stop beaconining
lockPref("browser.send_pings", false);
lockPref("beacon.enabled", false);
// battery tracking
lockPref("dom.battery.enabled", false);
// copy paste interference
lockPref("dom.event.clipboardevents.enabled", false);
// referer trimming, remove full url from referer to defeat tracking
// 0 : default, 1 : no query string, 2 : just scheme://host:port
lockPref("network.http.referer.trimmingPolicy", 2);

// do away with speculative connections and prefetching
lockPref("browser.urlbar.speculativeConnect.enabled", false);
lockPref("network.prefetch-next", false);
lockPref("network.dns.disablePrefetch", true);

// mess with phishing by not removing punycode
lockPref("network.IDN_show_punycode", true);

// don't suggest because it reveals what I am typing
lockPref("browser.search.suggest.enabled", false);
lockPref("browser.urlbar.suggest.searches", false);

// better search engine default
pref("browser.urlbar.placeholderName", "DuckDuckGo");

//// Privacy from mozilla
// remove some info from blocklist url
lockPref("extensions.blocklist.url", "https://blocklists.settings.services.mozilla.com/v1/blocklist/3/%20/%20/");

// remove this pocket online thing
lockPref("extensions.pocket.enabled", false);

// crash reports
lockPref("browser.tabs.crashReporting.sendReport", false);
lockPref("browser.crashReports.unsubmittedCheck.enabled", false);
lockPref("browser.crashReports.unsubmittedCheck.autoSubmit2", false);

// captivedetect pings a lot so you might want to move it...
//pref("captivedetect.canonicalURL", "");
//pref("captivedetect.canonicalContent", "success");
// or disable it:
//pref("network.captive-portal-service.enabled", false);

// normandy is a mozilla program to roll out different default settings to
// test them in advance.
lockPref("app.normandy.enabled", false);

// optoutstudies gtfo
lockPref("app.shield.optoutstudies.enabled", false);

// lock away the health report telemetry
lockPref("datareporting.healthreport.uploadEnabled", false);

// any overt telemetry
lockPref("browser.newtabpage.activity-stream.telemetry", false);
lockPref("browser.newtabpage.activity-stream.telemetry.ut.events", false);
lockPref("browser.newtabpage.activity-stream.feeds.telemetry", false);
lockPref("devtools.onboarding.telemetry.logged", false);
lockPref("browser.ping-centre.telemetry", false);
// Telemetry does not like to honor the global off setting,
// so we will be removing the server url to curb their trickery.
lockPref("toolkit.telemetry.server", "");
// off anyway lockPref("toolkit.telemetry.enabled", false);
lockPref("toolkit.telemetry.updatePing.enabled", false);
lockPref("toolkit.telemetry.shutdownPingSender.enabled", false);
lockPref("toolkit.telemetry.newProfilePing.enabled", false);
lockPref("toolkit.telemetry.firstShutdownPing.enabled", false);
lockPref("toolkit.telemetry.archive.enabled", false);
lockPref("toolkit.telemetry.unified", false);
lockPref("toolkit.telemetry.bhrPing.enabled", false);
lockPref("toolkit.telemetry.debugSlowSql", false);
lockPref("toolkit.telemetry.hybridContent.enabled", false);
// opt out of "is telemetry enabled" telemetry that mozilla tricks ff into
// doing sometimes. Not confirmed.
lockPref("toolkit.telemetry.coverage.opt-out", true);

// ssl error reporting
pref("security.ssl.errorReporting.enabled", false);

// WTF are experiments
lockPref("network.allow-experiments", false);
lockPref("experiments.enabled", false);

// firefox accounts not disabled despite policy
lockPref("identity.fxaccounts.enabled", false);
